<%= simple_form_for product_supplier,
  url: product_supplier.new_record? ?
        supplier_products_path(@supplier) :
        supplier_product_path(@supplier, product_supplier) do |f| %>
  <%= render 'layouts/error_messages', object: product_supplier %>
  <div class="row">

    <div class="col-lg-12">
      <% if product_supplier.new_record? %>
        <%= f.association :product,
            collection: Product.non_deleted.order(:sku),
            label_method: lambda { |p| "#{p.sku} - #{p.name}" },
            value_method: :id,
            prompt: 'Select Product',
            required: true,
            input_html: { class: 'form-control' },
            hint: 'Select the product this supplier can provide' %>
      <% else %>
        <div class="alert alert-info mb-3">
          <strong>Product:</strong>
          <%= product_supplier.product.name_with_sku %>
        </div>
        <%= f.hidden_field :product_id %>
      <% end %>
    </div>
    <!-- LEFT COLUMN -->
    <div class="col-md-6">
      <h6 class="text-primary mb-3">
        <i class="bi bi-currency-dollar me-2"></i>Pricing Information
      </h6>

      <%= f.input :supplier_item_code,
                  label: "Supplier's Part Number",
                  placeholder: 'e.g., SUPP-12345',
                  hint: "Supplier's internal part/item code" %>

      <%= f.input :current_unit_price,
                  label: 'Current Unit Price',
                  required: true,
                  input_html: { step: 0.0001, min: 0 },
                  prepend: '$' %>

      <!-- Volume Pricing -->
      <div class="card bg-light mb-3">
        <div class="card-body">
          <h6 class="card-title mb-3">
            <i class="bi bi-bar-chart-steps me-2"></i>Volume Pricing
          </h6>

          <div class="row">
            <div class="col-6">
              <%= f.input :price_break_1_qty,
                          label: 'Qty 1',
                          input_html: { min: 0 } %>
            </div>
            <div class="col-6">
              <%= f.input :price_break_1_price,
                          label: 'Price 1',
                          prepend: '$',
                          input_html: { step: 0.0001 } %>
            </div>
          </div>

          <div class="row">
            <div class="col-6">
              <%= f.input :price_break_2_qty,
                          label: 'Qty 2',
                          input_html: { min: 0 } %>
            </div>
            <div class="col-6">
              <%= f.input :price_break_2_price,
                          label: 'Price 2',
                          prepend: '$',
                          input_html: { step: 0.0001 } %>
            </div>
          </div>

          <div class="row">
            <div class="col-6">
              <%= f.input :price_break_3_qty,
                          label: 'Qty 3',
                          input_html: { min: 0 } %>
            </div>
            <div class="col-6">
              <%= f.input :price_break_3_price,
                          label: 'Price 3',
                          prepend: '$',
                          input_html: { step: 0.0001 } %>
            </div>
          </div>
        </div>
      </div>

      <%= f.input :lead_time_days,
                  required: true,
                  input_html: { min: 0 } %>

      <%= f.input :minimum_order_quantity,
                  input_html: { min: 0 } %>

      <%= f.input :order_multiple,
                  input_html: { min: 0 } %>
    </div>

    <!-- RIGHT COLUMN -->
    <div class="col-md-6">
      <h6 class="text-primary mb-3">
        <i class="bi bi-shield-check me-2"></i>Quality & Strategic Info
      </h6>

      <%= f.input :quality_rating,
                  input_html: { min: 0, max: 100 } %>

      <%= f.input :delivery_performance_rating,
                  input_html: { min: 0, max: 100 } %>

      <%= f.input :supplier_rank,
                  collection: [
                    ['Primary (1st choice)', 1],
                    ['Secondary (2nd choice)', 2],
                    ['Tertiary (3rd choice)', 3],
                    ['Backup', 4]
                  ],
                  include_blank: 'Not Ranked', input_html: {class: 'form-control'} %>

      <div class="card bg-light mb-3">
        <div class="card-body">
          <h6 class="card-title">Strategic Flags</h6>

          <%= f.input :is_preferred_supplier, as: :boolean %>
          <%= f.input :is_approved_supplier, as: :boolean %>
          <%= f.input :is_sole_source, as: :boolean %>
        </div>
      </div>

      <%= f.input :sourcing_strategy,
                  collection: [
                    ['Single Source', 'SINGLE_SOURCE'],
                    ['Dual Source', 'DUAL_SOURCE'],
                    ['Multi Source', 'MULTI_SOURCE']
                  ],
                  include_blank: 'Not Defined', input_html: {class: 'form-control'} %>

      <%= f.input :packaging_type %>

      <div class="card bg-light">
        <div class="card-body">
          <h6 class="card-title">Compliance Requirements</h6>

          <%= f.input :requires_quality_cert, as: :boolean %>
          <%= f.input :requires_coc, as: :boolean %>
          <%= f.input :requires_msds, as: :boolean %>
        </div>
      </div>
    </div>
  </div>

  <hr class="my-4">

  <%= f.button :submit,
               product_supplier.new_record? ? 'Add Product' : 'Update Product',
               class: 'btn btn-primary' %>

<% end %>