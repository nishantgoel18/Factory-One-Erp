<!-- app/views/setup_wizard/show.html.erb -->
<div class="main-content">
  <%= render 'layouts/alerts' %>

  <div class="page-header">
    <h2 class="header-title">Welcome to <%= @organization.name %></h2>

    <div class="header-sub-title">
      <nav class="breadcrumb breadcrumb-dash">
        <%= link_to raw('<i class="anticon anticon-home m-r-5"></i>Home'), root_path, class: "breadcrumb-item" %>
        <span class="breadcrumb-item active">Welcome to <%= @organization.name %></span>
      </nav>
    </div>
  </div>
  <div class="container pb-5">
    <div class="row justify-content-center">
      <div class="col-lg-10">
        <!-- Progress Header -->
        <div class="card mb-4">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h3 class="mb-0 fw-bold">ðŸš€ Welcome to <%= @organization.name %>!</h3>
              <%= link_to "Skip for now â†’", skip_setup_wizard_path, class: "btn btn-sm btn-outline-secondary" %>
            </div>
            
            <div class="progress" style="height: 8px;">
              <div class="progress-bar bg-success" role="progressbar" 
                   style="width: <%= @organization.setup_progress_percentage %>%"
                   aria-valuenow="<%= @organization.setup_progress_percentage %>" 
                   aria-valuemin="0" aria-valuemax="100">
              </div>
            </div>
            <p class="text-muted small mt-2 mb-0">
              Setup Progress: <%= @organization.setup_progress_percentage %>% complete
            </p>
          </div>
        </div>

        <!-- Step Navigation -->
        <div class="card mb-4">
          <div class="card-body">
            <div class="row text-center">
              <div class="col">
                <div class="step-item <%= 'active' if @step == 1 %> <%= 'completed' if @step > 1 %>">
                  <div class="step-number">1</div>
                  <div class="step-label">Company Info</div>
                </div>
              </div>
              <div class="col">
                <div class="step-item <%= 'active' if @step == 2 %> <%= 'completed' if @step > 2 %>">
                  <div class="step-number">2</div>
                  <div class="step-label">Fiscal Settings</div>
                </div>
              </div>
              <div class="col">
                <div class="step-item <%= 'active' if @step == 3 %> <%= 'completed' if @step > 3 %>">
                  <div class="step-number">3</div>
                  <div class="step-label">MRP Config</div>
                </div>
              </div>
              <div class="col">
                <div class="step-item <%= 'active' if @step == 4 %>">
                  <div class="step-number">4</div>
                  <div class="step-label">Complete</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Step Content -->
        <div class="card">
          <div class="card-body">
            <% case @step %>
            <% when 1 %>
              <%= render 'step_company' %>
            <% when 2 %>
              <%= render 'step_fiscal' %>
            <% when 3 %>
              <%= render 'step_mrp' %>
            <% when 4 %>
              <%= render 'step_complete' %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.step-item {
  position: relative;
  padding: 10px;
}

.step-number {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: #e9ecef;
  color: #6c757d;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  font-weight: bold;
  margin: 0 auto 10px;
  border: 3px solid #e9ecef;
}

.step-item.active .step-number {
  background: #0d6efd;
  color: white;
  border-color: #0d6efd;
  animation: pulse 2s infinite;
}

.step-item.completed .step-number {
  background: #198754;
  color: white;
  border-color: #198754;
}

.step-item.completed .step-number::after {
  content: "âœ“";
  font-size: 24px;
}

.step-label {
  font-size: 14px;
  font-weight: 600;
  color: #6c757d;
}

.step-item.active .step-label {
  color: #0d6efd;
}

.step-item.completed .step-label {
  color: #198754;
}

@keyframes pulse {
  0% {
    box-shadow: 0 0 0 0 rgba(13, 110, 253, 0.7);
  }
  70% {
    box-shadow: 0 0 0 10px rgba(13, 110, 253, 0);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(13, 110, 253, 0);
  }
}
</style>