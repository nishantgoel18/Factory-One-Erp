<%# app/views/journal_entries/show.html.erb %>

<div class="main-content">
  <%= render 'layouts/alerts' %>
  <div class="page-header">
    <h2 class="header-title">View Journal Entry</h2>

    <div class="header-sub-title">
      <nav class="breadcrumb breadcrumb-dash">
        <%= link_to raw('<i class="anticon anticon-home m-r-5"></i>Home'), root_path, class: "breadcrumb-item" %>
        <%= link_to "Finance", "#", class: "breadcrumb-item" %>
        <%= link_to "Journal Entries", journal_entries_path, class: "breadcrumb-item" %>
        <span class="breadcrumb-item active">Journal Entry Details</span>
      </nav>
    </div>
  </div>

  <div class="row">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-body">
          
          <div class="table-responsive">
            <table class="table table-bordered">
              <tbody>
                <tr>
                  <th width="25%">Entry Number</th>
                  <td><%= @journal_entry.entry_number %></td>
                </tr>

                <tr>
                  <th>Entry Date</th>
                  <td><%= @journal_entry.entry_date %></td>
                </tr>

                <tr>
                  <th>Accounting Period</th>
                  <td><%= @journal_entry.accounting_period.presence || "Not Available" %></td>
                </tr>

                <tr>
                  <th>Description</th>
                  <td><%= @journal_entry.description.presence || "Not Available" %></td>
                </tr>

                <tr>
                  <th>Reference Type</th>
                  <td><%= JournalEntry::REF_TYPE_CHOICES[@journal_entry.reference_type] || "Not Available" %></td>
                </tr>

                <tr>
                  <th>Reference ID</th>
                  <td><%= @journal_entry.reference_id.presence || "Not Available" %></td>
                </tr>

                <tr>
                  <th>Posted At</th>
                  <td>
                    <% if @journal_entry.posted_at.present? %>
                      <%= @journal_entry.posted_at.strftime("%b %d, %Y %I:%M %p") %>
                    <% else %>
                      Not Posted
                    <% end %>
                  </td>
                </tr>

                <tr>
                  <th>Posted By</th>
                  <td>
                    <% if @journal_entry.posted_by_user %>
                      <%= @journal_entry.posted_by_user.full_name %>
                    <% else %>
                      Not Available
                    <% end %>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <br>

          <h4>Journal Lines</h4>
          <div class="table-responsive">
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th>Account</th>
                  <th>Description</th>
                  <th>Debit</th>
                  <th>Credit</th>
                </tr>
              </thead>

              <tbody>
                <% @journal_entry.journal_lines.non_deleted.each do |line| %>
                  <tr>
                    <td><%= line.account.name %></td>
                    <td><%= line.description.presence || "-" %></td>
                    <td><%= number_to_currency(line.debit) %></td>
                    <td><%= number_to_currency(line.credit) %></td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>

          <br>

          <%= render 'actions', je: @journal_entry %>
        </div>
      </div>
    </div>
  </div>
</div>