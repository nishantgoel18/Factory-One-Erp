<% if customer.documents.any? %>
  <div class="table-responsive">
    <table class="table table-hover">
      <thead class="table-light">
        <tr>
          <th width="40"><i class="bi bi-file-earmark"></i></th>
          <th>Document</th>
          <th>Type</th>
          <th>Effective Date</th>
          <th>Expiry Date</th>
          <th>Status</th>
          <th width="150">Actions</th>
        </tr>
      </thead>
      <tbody>
        <% customer.documents.order(created_at: :desc).each do |document| %>
          <tr id="document_<%= document.id %>" class="<%= 'table-warning' if document.expiring_soon?(30) %>">
            <td>
              <i class="bi bi-file-earmark-<%= document.file_attached? ? 'pdf' : 'text' %> fs-4 text-primary"></i>
            </td>
            
            <td>
              <strong><%= document.document_title %></strong>
              <% if document.description.present? %>
                <br><small class="text-muted"><%= truncate(document.description, length: 60) %></small>
              <% end %>
              <% if document.file_attached? %>
                <br><small class="text-muted">
                  <i class="bi bi-paperclip me-1"></i>
                  <%= document.file_name %> (<%= number_to_human_size(document.file_size) %>)
                </small>
              <% end %>
              <% if document.version.present? && document.version > 1 %>
                <br><span class="badge bg-secondary">Version <%= document.version %></span>
              <% end %>
            </td>
            
            <td>
              <span class="badge bg-info text-white">
                <%= document.document_type %>
              </span>
              <% if document.document_category.present? %>
                <br><small class="text-muted"><%= document.document_category %></small>
              <% end %>
            </td>
            
            <td>
              <% if document.effective_date.present? %>
                <%= document.effective_date.strftime("%m/%d/%Y") %>
              <% else %>
                <span class="text-muted">-</span>
              <% end %>
            </td>
            
            <td>
              <% if document.expiry_date.present? %>
                <%= document.expiry_date.strftime("%m/%d/%Y") %>
                <% if document.expired? %>
                  <br><span class="badge bg-danger">Expired</span>
                <% elsif document.expiring_soon?(30) %>
                  <br><span class="badge bg-warning text-dark">
                    Expires in <%= document.days_until_expiry %> days
                  </span>
                <% end %>
              <% else %>
                <span class="text-muted">No expiry</span>
              <% end %>
            </td>
            
            <td>
              <% if document.is_active? %>
                <span class="badge bg-success">Active</span>
              <% else %>
                <span class="badge bg-secondary">Inactive</span>
              <% end %>
              <% if document.is_confidential? %>
                <br><span class="badge bg-danger mt-1">
                  <i class="bi bi-lock-fill me-1"></i>Confidential
                </span>
              <% end %>
            </td>
            
            <td>
              <div class="btn-group btn-group-sm">
                <% if document.file_attached? %>
                  <%= link_to download_customer_document_path(customer, document),
                             class: "btn btn-outline-primary",
                             title: "Download",
                             target: "_blank" do %>
                    <i class="bi bi-download"></i>
                  <% end %>
                <% end %>
                <button type="button" class="btn btn-outline-secondary"
                        onclick="editDocument(<%= customer.id %>, <%= document.id %>)"
                        title="Edit">
                  <i class="bi bi-pencil"></i>
                </button>
                <button type="button" class="btn btn-outline-danger"
                        onclick="deleteDocument(<%= customer.id %>, <%= document.id %>)"
                        title="Delete">
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% else %>
  <!-- Empty State -->
  <div class="text-center py-5">
    <i class="bi bi-file-earmark display-3 text-muted"></i>
    <p class="mt-3 text-muted">No documents uploaded yet</p>
    <button type="button" class="btn btn-primary" onclick="addDocument()">
      <i class="bi bi-upload me-1"></i>Upload First Document
    </button>
  </div>
<% end %>